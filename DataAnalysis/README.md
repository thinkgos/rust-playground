# 数据分析

- [polars](https://docs.pola.rs)
- [statrs](https://github.com/statrs-dev/statrs)Statistical computation library for Rust

## 1. 统计分析

### 1.1 最小值(min)

$$Min = \min_{i=1}^{n}x_i$$

### 1.1.1 最大值(max)

$$Max = \max_{i=1}^{n}x_i$$

### 1.1.2 总和(sum)

$$Sum = \sum_{i=1}^{n}x_i$$

### 1.1.3 平均值(mean)

$$Mean = \mu = \frac{1}{n}\sum_{i=1}^{n}x_i$$

### 1.1.4 中位数(median)

如果数据样本是有序的, 中位数是位于中间位置的数值.

- 如果数据样本的数量是奇数, 中位数就是位于中间位置的数值；

$$\text{Median} = x_{\left(\frac{n+1}{2}\right)}$$

- 如果数据样本的数量是偶数, 中位数就是中间两个数值的平均值.
$$\text{Median} = \frac{x_{\left(\frac{n}{2}\right)} + x_{\left(\frac{n}{2} + 1\right)}}{2}$$

### 1.1.5 方差(variance)/标准差(standard deviation)

- 求均值($\mu$): 算出所有数字的平均数.
- 算偏差: 用每个数字减去均值.
- 平方处理: 把得到的偏差全部平方(为了消除负号).
- 算平均平方值(方差): 把这些平方后的数字加起来, 除以总个数n.这步得到的结果叫**方差**(Variance).

$$\sigma^2 = \frac{\sum_{i=1}^{n}(x_i - \mu)^2}{n}$$

- 开平方根: 对**方差**进行开根号, 就得到了**标准差**.

$$\sigma = \sqrt{\sigma^2} = \sqrt{\frac{\sum_{i=1}^{n}(x_i - \mu)^2}{n}}$$

### 1.1.6 数据标准化(Z-Score)/Standardization/零-均值规范化

它的核心目标是将不同量纲(单位)和分布范围的数据转化为统一的标准尺度, 使数据呈现出均值为0, 标准差为1的特性.

$$Z_x = \frac{x_i - \mu}{\sigma}$$

- $x_i$: 第i个数据样本.
- $\mu$: 样本数据的平均值(Mean).
- $\sigma$: 样本数据的标准差(Standard Deviation).

### 1.1.7 直方图(histogram)

它通过将数据切分成不同的区间(称为"组"或"桶"), 并用矩形的高度来表示数据落在该区间的频率或频数.

直方图的核心组成

- 横轴(X轴)：表示数据的范围.它被划分为多个连续且不重叠的区间(Bins).
- 纵轴(Y轴)：表示数据出现的频率(百分比)或频数(次数).
- 矩形柱：每个柱子的宽度代表区间范围, 高度代表该区间内的数据量.在标准直方图中, 柱子之间是没有间隔的, 这代表了数据的连续性.

### 1.1.8 分位数(quantile)

它将一组按大小顺序排列的数据, 划分为等份的若干部分, 用来反映数据的分布特征和位置.
其中**中位数**是分位数的一种特殊情况, 它将数据样本分为上下两部分, 各占50%的概率.

- `nearest` 最近邻法, 取距离计算出的索引i最近的那个整数索引对应的值.  
- `lower` 下确界法, 无论小数部分是多少, 始终向下取整.
- `higher` 上确界法, 无论小数部分是多少, 始终向上取整.
- `midpoint` 中点法, 取i左右两侧相邻两个观测值的算术平均数.
- `linear` 线性插值法, 根据索引的小数部分, 在两个相邻值之间进行比例分配.
- `equiprobable` 等概率法.

### 1.1.9 加权分位数(weighted quantile)

加权分位数(Weighted Quantile)是普通分位数的进阶版. 在普通分位数中, 每个观测值的"话语权"是相等的(权重都是$1/n$); 而在加权分位数中, 每个数值都被赋予了一个特定的权重(Weight), 权重越大的值对分位数位置的影响就越大.

### 1.1.10 切比雪夫定理/切比雪夫不等式

对于任何随机变量 $X$, 如果其均值为 $\mu$, 标准差为 $\sigma$, 那么对于任意大于 1 的常数 $k$, 数据落在 $k$ 个标准差范围内的概率(比例)满足: $$P(|X - \mu| < k\sigma) \geq 1 - \frac{1}{k^2}$$或者, 数据落在该范围之外的概率满足: $$P(|X - \mu| \geq k\sigma) \leq \frac{1}{k^2}$$

根据公式, 我们可以推导出几个常用的结论:

- $k = 2$: 至少有 $1 - 1/2^2 = 75\%$ 的数据, 落在距离均值2个标准差的范围内.
- $k = 3$: 至少有 $1 - 1/3^2 \approx 88.9\%$ 的数据, 落在距离均值3个标准差的范围内.
- $k = 5$: 至少有 $96\%$ 的数据, 落在距离均值5个标准差的范围内.
